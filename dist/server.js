"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _winston = _interopRequireDefault(require("./external-libs/winston"));

var _mongoose = require("./external-libs/mongoose");

var _redis = _interopRequireDefault(require("./external-libs/redis"));

var _ = _interopRequireDefault(require("."));

var serverPort = Number(process.env.SERVER_PORT || 9000);
(0, _mongoose.connect)().then(function () {
  var host = process.env.MONGO_DEFAULT_HOST;
  var port = process.env.MONGO_DEFAULT_PORT;
  var dbName = process.env.MONGO_DEFAULT_DB_NAME;

  _winston.default.info("Mongo|Connected mongodb://".concat(host, ":").concat(port, "/").concat(dbName));

  return _redis.default.ping();
}).then(function (status) {
  var host = process.env.REDIS_DEFAULT_HOST;
  var port = process.env.REDIS_DEFAULT_PORT;
  var db = process.env.REDIS_DEFAULT_DB;

  _winston.default.info("Redis|Connected ".concat(status, " redis://").concat(host, ":").concat(port, "/").concat(db));

  _.default.listen(serverPort, function () {
    _winston.default.info("Server|Started http://127.0.0.1:".concat(serverPort));
  });
}).catch(function (error) {
  _winston.default.error(error);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9zZXJ2ZXIuanMiXSwibmFtZXMiOlsic2VydmVyUG9ydCIsIk51bWJlciIsInByb2Nlc3MiLCJlbnYiLCJTRVJWRVJfUE9SVCIsInRoZW4iLCJob3N0IiwiTU9OR09fREVGQVVMVF9IT1NUIiwicG9ydCIsIk1PTkdPX0RFRkFVTFRfUE9SVCIsImRiTmFtZSIsIk1PTkdPX0RFRkFVTFRfREJfTkFNRSIsImxvZ2dlciIsImluZm8iLCJSZWRpcyIsInBpbmciLCJzdGF0dXMiLCJSRURJU19ERUZBVUxUX0hPU1QiLCJSRURJU19ERUZBVUxUX1BPUlQiLCJkYiIsIlJFRElTX0RFRkFVTFRfREIiLCJhcHAiLCJsaXN0ZW4iLCJjYXRjaCIsImVycm9yIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBRUEsSUFBTUEsVUFBVSxHQUFHQyxNQUFNLENBQUNDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxXQUFaLElBQTJCLElBQTVCLENBQXpCO0FBQ0EseUJBQ0dDLElBREgsQ0FDUSxZQUFNO0FBQ1YsTUFBTUMsSUFBSSxHQUFHSixPQUFPLENBQUNDLEdBQVIsQ0FBWUksa0JBQXpCO0FBQ0EsTUFBTUMsSUFBSSxHQUFHTixPQUFPLENBQUNDLEdBQVIsQ0FBWU0sa0JBQXpCO0FBQ0EsTUFBTUMsTUFBTSxHQUFHUixPQUFPLENBQUNDLEdBQVIsQ0FBWVEscUJBQTNCOztBQUNBQyxtQkFBT0MsSUFBUCxxQ0FBeUNQLElBQXpDLGNBQWlERSxJQUFqRCxjQUF5REUsTUFBekQ7O0FBQ0EsU0FBT0ksZUFBTUMsSUFBTixFQUFQO0FBQ0QsQ0FQSCxFQVFHVixJQVJILENBUVEsVUFBQVcsTUFBTSxFQUFJO0FBQ2QsTUFBTVYsSUFBSSxHQUFHSixPQUFPLENBQUNDLEdBQVIsQ0FBWWMsa0JBQXpCO0FBQ0EsTUFBTVQsSUFBSSxHQUFHTixPQUFPLENBQUNDLEdBQVIsQ0FBWWUsa0JBQXpCO0FBQ0EsTUFBTUMsRUFBRSxHQUFHakIsT0FBTyxDQUFDQyxHQUFSLENBQVlpQixnQkFBdkI7O0FBQ0FSLG1CQUFPQyxJQUFQLDJCQUErQkcsTUFBL0Isc0JBQWlEVixJQUFqRCxjQUF5REUsSUFBekQsY0FBaUVXLEVBQWpFOztBQUVBRSxZQUFJQyxNQUFKLENBQVd0QixVQUFYLEVBQXVCLFlBQU07QUFDM0JZLHFCQUFPQyxJQUFQLDJDQUErQ2IsVUFBL0M7QUFDRCxHQUZEO0FBR0QsQ0FqQkgsRUFrQkd1QixLQWxCSCxDQWtCUyxVQUFBQyxLQUFLLEVBQUk7QUFDZFosbUJBQU9ZLEtBQVAsQ0FBYUEsS0FBYjtBQUNELENBcEJIIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGxvZ2dlciBmcm9tIFwiLi9leHRlcm5hbC1saWJzL3dpbnN0b25cIjtcbmltcG9ydCB7IGNvbm5lY3QgYXMgY29ubmVjdE1vbmdvREIgfSBmcm9tIFwiLi9leHRlcm5hbC1saWJzL21vbmdvb3NlXCI7XG5pbXBvcnQgUmVkaXMgZnJvbSBcIi4vZXh0ZXJuYWwtbGlicy9yZWRpc1wiO1xuXG5pbXBvcnQgYXBwIGZyb20gXCIuXCI7XG5cbmNvbnN0IHNlcnZlclBvcnQgPSBOdW1iZXIocHJvY2Vzcy5lbnYuU0VSVkVSX1BPUlQgfHwgOTAwMCk7XG5jb25uZWN0TW9uZ29EQigpXG4gIC50aGVuKCgpID0+IHtcbiAgICBjb25zdCBob3N0ID0gcHJvY2Vzcy5lbnYuTU9OR09fREVGQVVMVF9IT1NUO1xuICAgIGNvbnN0IHBvcnQgPSBwcm9jZXNzLmVudi5NT05HT19ERUZBVUxUX1BPUlQ7XG4gICAgY29uc3QgZGJOYW1lID0gcHJvY2Vzcy5lbnYuTU9OR09fREVGQVVMVF9EQl9OQU1FO1xuICAgIGxvZ2dlci5pbmZvKGBNb25nb3xDb25uZWN0ZWQgbW9uZ29kYjovLyR7aG9zdH06JHtwb3J0fS8ke2RiTmFtZX1gKTtcbiAgICByZXR1cm4gUmVkaXMucGluZygpO1xuICB9KVxuICAudGhlbihzdGF0dXMgPT4ge1xuICAgIGNvbnN0IGhvc3QgPSBwcm9jZXNzLmVudi5SRURJU19ERUZBVUxUX0hPU1Q7XG4gICAgY29uc3QgcG9ydCA9IHByb2Nlc3MuZW52LlJFRElTX0RFRkFVTFRfUE9SVDtcbiAgICBjb25zdCBkYiA9IHByb2Nlc3MuZW52LlJFRElTX0RFRkFVTFRfREI7XG4gICAgbG9nZ2VyLmluZm8oYFJlZGlzfENvbm5lY3RlZCAke3N0YXR1c30gcmVkaXM6Ly8ke2hvc3R9OiR7cG9ydH0vJHtkYn1gKTtcblxuICAgIGFwcC5saXN0ZW4oc2VydmVyUG9ydCwgKCkgPT4ge1xuICAgICAgbG9nZ2VyLmluZm8oYFNlcnZlcnxTdGFydGVkIGh0dHA6Ly8xMjcuMC4wLjE6JHtzZXJ2ZXJQb3J0fWApO1xuICAgIH0pO1xuICB9KVxuICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgIGxvZ2dlci5lcnJvcihlcnJvcik7XG4gIH0pO1xuIl19